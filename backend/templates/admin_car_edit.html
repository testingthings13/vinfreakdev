{% extends "_base.html" %}
{% block content %}
<h1>{{ 'Edit' if car else 'New' }} Car</h1>
<form class="form" method="post" action="{{ action }}">
  <input type="hidden" name="csrf" value="{{ csrf }}">
  <div class="grid">
    <label>VIN <input name="vin" value="{{ car.vin if car else '' }}"></label>
    <label>Year <input type="number" name="year" value="{{ car.year if car else '' }}"></label>
    <label>Make
      <select name="make_id">
        <option value=""></option>
        {% for m in makes %}
          <option value="{{ m.id }}" {{ 'selected' if car and car.make_id==m.id else '' }}>{{ m.name }}</option>
        {% endfor %}
      </select>
    </label>
    <label>Model
      <select name="model_id">
        <option value=""></option>
        {% for m in models %}
          <option value="{{ m.id }}" {{ 'selected' if car and car.model_id==m.id else '' }}>{{ m.name }}</option>
        {% endfor %}
      </select>
    </label>
    <label>Category
      <select name="category_id">
        <option value=""></option>
        {% for c in categories %}
          <option value="{{ c.id }}" {{ 'selected' if car and car.category_id==c.id else '' }}>{{ c.name }}</option>
        {% endfor %}
      </select>
    </label>
    <label>Dealership
      <select name="dealership_id">
        <option value=""></option>
        {% for d in dealerships %}
          <option value="{{ d.id }}" {{ 'selected' if car and car.dealership_id==d.id else '' }}>{{ d.name }}</option>
        {% endfor %}
      </select>
    </label>
    <label>Trim <input name="trim" value="{{ car.trim if car else '' }}"></label>
    <label>Price <input type="number" step="0.01" name="price" value="{{ car.price if car else '' }}"></label>
    <label>Mileage <input type="number" name="mileage" value="{{ car.mileage if car else '' }}"></label>
    <label>Currency <input name="currency" value="{{ car.currency if car else 'USD' }}"></label>
    <label>City <input name="city" value="{{ car.city if car else '' }}"></label>
    <label>State <input name="state" value="{{ car.state if car else '' }}"></label>
    <label>Status
      <select name="auction_status">
        {% set st = (car.auction_status if car else '')|upper %}
        {% for s in ['LIVE','SOLD','RESERVE_NOT_MET','ENDED','DRAFT'] %}
          <option value="{{ s }}" {{ 'selected' if st==s else '' }}>{{ s }}</option>
        {% endfor %}
      </select>
    </label>
    <label>Lot # <input name="lot_number" value="{{ car.lot_number if car else '' }}"></label>
    <label>Source <input name="source" value="{{ car.source if car else '' }}"></label>
    <label>Source URL <input name="url" value="{{ car.url if car else '' }}"></label>
    <label>Title <input name="title" value="{{ car.title if car else '' }}"></label>
    <label>Main image URL <input name="image_url" value="{{ car.image_url if car else '' }}"></label>
    <label>Additional image URLs
      <textarea name="images_json" rows="3">{{ images_text if images_text else '' }}</textarea>
    </label>
    <label>Posted At <input name="posted_at" value="{{ car.posted_at if car else '' }}" placeholder="YYYY-MM-DDThh:mm:ssZ"></label>
    <label>Seller Name <input name="seller_name" value="{{ car.seller_name if car else '' }}"></label>
    <label>Seller Rating <input name="seller_rating" value="{{ car.seller_rating if car else '' }}"></label>
    <label>Seller Reviews <input name="seller_reviews" value="{{ car.seller_reviews if car else '' }}"></label>
    <label>Location Address <input name="location_address" value="{{ car.location_address if car else '' }}"></label>
    <label>Location URL <input name="location_url" value="{{ car.location_url if car else '' }}"></label>
    <label>End Time <input name="end_time" value="{{ car.end_time if car else '' }}" placeholder="YYYY-MM-DDThh:mm:ssZ"></label>
    <label>Time Left <input name="time_left" value="{{ car.time_left if car else '' }}"></label>
    <label>Views <input type="number" name="number_of_views" value="{{ car.number_of_views if car else '' }}"></label>
    <label>Bids <input type="number" name="number_of_bids" value="{{ car.number_of_bids if car else '' }}"></label>
  </div>
  <label>Description
    <textarea name="description" rows="6">{{ car.description if car else '' }}</textarea>
  </label>
  <button type="submit">Save</button>
</form>
{% endblock %}
